# AI-Automated Customer Service Based On Email

## Overview

This workflow automates customer service email processing and response using AI and Google Sheets. When a new, unread email is received, the workflow categorizes its content (e.g., Sales Enquiry, Customer Feedback, Complaint) using OpenAI GPT, matches the category to a response template in Google Sheets, generates a personalized reply using AI, and sends it back to the original sender—all automatically.

---

## How It Works

1. **Email Trigger**  
   Monitors a designated email inbox for new, unread messages.

2. **Email Categorization (AI)**  
   Uses OpenAI's GPT-3.5-turbo to analyze and categorize the incoming email text into:
   - Sales Enquiry
   - Customer Feedback
   - Complaint

3. **Template Lookup (Google Sheets)**  
   Searches a Google Sheet (`Customer Feedback` > `Sheet1`) for a response template matching the determined category.

4. **Draft Response (AI)**  
   Passes the template—merged with the customer's original email—to OpenAI GPT to generate a tailored response.

5. **Send Reply**  
   Emails the AI-generated reply to the original sender, using the original subject line as the reference.

6. **Delay**  
   Optional: Waits briefly (30 seconds) before continuing or looping through the next steps.

---

## Inputs

- **Email Account:** Connection to a monitored mailbox (IMAP, Gmail, or similar).
- **OpenAI Account:** Connection credentials/token for GPT-3.5-turbo access.
- **Google Sheets:** Access to the relevant spreadsheet containing response templates, with categories as the first column.
- **Monitored Folder:** Typically `INBOX`.
- **Email Fetch Criteria:** Only unread (`UNSEEN`) emails are processed.

### Email Parameters Example

| Parameter  | Description                        | Example                   |
|----------|------------------------------------|---------------------------|
| folder   | Source mail folder                  | INBOX                     |
| criteria | Selection criteria                  | UNSEEN (unread only)      |
| maxResults| Number of emails to fetch         | 1                         |

### Google Sheets Requirements

- The spreadsheet should have a column (A) listing categories exactly as output by OpenAI (e.g., "Complaint").
- Column B contains response templates/prompts relevant to the category.
- File: `Customer Feedback`, Sheet: `Sheet1`.

---

## Outputs

- **Automated Customer Response Email:**  
  A personalized reply generated by OpenAI and based on the matched template is sent to the original sender.

- **Categorization Log (Optional):**  
  Discoverable via Google Sheets filter action—can be extended for logging or further analytics.

---

## Modules Used

1. **Email: New Email Trigger**  
   - Detects new, unread message.

2. **OpenAI GPT-3.5-turbo**  
   - Categorizes email.
   - Generates the customer response.

3. **Google Sheets: Filter Rows**  
   - Finds the response template that matches the detected category.

4. **Email: Send Email**  
   - Sends the AI-generated response to the customer.

---

## Customization & Extension

- **Add new categories or templates:**  
  Update the Google Sheet with new rows as needed.

- **Edit AI prompt logic:**  
  Adjust GPT input or templates for different reply tone or detail.

- **Logging or analytics:**  
  Extend the workflow to log categorized emails or responses.

---

## Notes

- Make sure all accounts (email, Google, OpenAI) are properly connected and authorized.
- The workflow processes one unread email per run (can be adjusted by changing `maxResults`).
- Handles only basic categories by default; refine categorization prompt for more options if needed.

---

## Summary Table

| Step                  | Input              | Processing                             | Output                   |
|-----------------------|--------------------|----------------------------------------|--------------------------|
| 1. Monitor inbox      | Email account      | Looks for unread emails                | Latest unread email      |
| 2. Categorization     | Email text         | OpenAI GPT-3.5-turbo categorizes       | Category label           |
| 3. Template lookup    | Category label     | Filters Google Sheet for matching row  | Reply template/prompt    |
| 4. Compose response   | Template + email   | GPT-3.5-turbo writes final response    | Drafted reply text       |
| 5. Send reply         | Reply text, sender | Email module sends message             | Customer email sent      |

---

## Setup Checklist

- [ ] Connect your monitored email account.
- [ ] Set up an OpenAI account and connection.
- [ ] Ensure your Google Sheet exists and is formatted correctly.
- [ ] Update folder names and IDs as needed for your environment.
- [ ] Activate